---
title: Восстановить книгу из диаграммы
linktitle: Восстановить книгу из диаграммы
second_title: Aspose.Slides .NET API обработки PowerPoint
description: Узнайте, как восстановить книгу из диаграммы с помощью Aspose.Slides для .NET. Извлекайте данные диаграммы и программно создавайте книги Excel.
type: docs
weight: 12
url: /ru/net/additional-chart-features/chart-recover-workbook/
---

## Введение

Могут произойти несчастные случаи, и вам может понадобиться восстановить книгу из диаграммы. В таких ситуациях на помощь приходит Aspose.Slides for .NET. Эта мощная библиотека позволяет извлекать данные из диаграмм в презентациях и преобразовывать их в новую книгу. В этом пошаговом руководстве мы покажем вам процесс восстановления книги из диаграммы с помощью Aspose.Slides для .NET.

## Предварительные условия

Прежде чем начать, убедитесь, что у вас есть следующее:

- Visual Studio: скачайте и установите Visual Studio, необходимую для разработки .NET.
-  Aspose.Slides для .NET: Вы можете скачать библиотеку с сайта[здесь](https://downloads.aspose.com/slides/net).

## Шаг 1. Установите Aspose.Slides для .NET

Если вы еще этого не сделали, скачайте и установите Aspose.Slides для .NET. Эта библиотека предоставляет комплексные функции для программной работы с презентациями PowerPoint.

## Шаг 2. Загрузите презентацию

Для начала создайте новый проект C# в Visual Studio. Добавьте ссылки на необходимые сборки Aspose.Slides. Загрузите презентацию PowerPoint, содержащую диаграмму, из которой вы хотите восстановить данные.

```csharp
// Загрузите презентацию
Presentation presentation = new Presentation("your-presentation.pptx");
```

## Шаг 3: Определите диаграмму

 Определите слайд и диаграмму, из которых вы хотите восстановить данные. Вы можете получить доступ к слайдам, используя`presentation.Slides` коллекции и диаграммы с использованием`slide.Shapes` коллекция.

```csharp
// Получить слайд, содержащий диаграмму
ISlide slide = presentation.Slides[0];

// Получить диаграмму
IChart chart = null;
foreach (IShape shape in slide.Shapes)
{
    if (shape is IChart)
    {
        chart = (IChart)shape;
        break;
    }
}
```

## Шаг 4. Извлечение данных из диаграммы

Извлеките данные из диаграммы с помощью API Aspose.Slides. Вы можете получать значения из серий и категорий диаграмм.

```csharp
// Извлечение данных диаграммы
IChartData chartData = chart.ChartData;
```

## Шаг 5. Создайте новую книгу

Создайте новую книгу Excel, используя такую библиотеку, как EPPlus или ClosedXML.

```csharp
// Создайте новую книгу Excel
using (var excelPackage = new ExcelPackage())
{
    var worksheet = excelPackage.Workbook.Worksheets.Add("Chart Data");
    // Добавьте сюда код для заполнения заголовков листов.
}
```

## Шаг 6. Заполнение книги данными диаграммы

Заполните лист Excel данными, извлеченными из диаграммы.

```csharp
//Заполнение листа Excel данными диаграммы
int rowIndex = 2;
foreach (var series in chartData.Series)
{
    worksheet.Cells[rowIndex, 1].Value = series.Name;
    // Добавьте сюда код, чтобы заполнить лист данными серии.
    rowIndex++;
}
```

## Шаг 7. Сохраните книгу

Сохраните книгу Excel с восстановленными данными диаграммы.

```csharp
// Сохраните книгу Excel
excelPackage.SaveAs(new FileInfo("recovered-workbook.xlsx"));
```

## Заключение

Восстановление книги из диаграммы упрощается с помощью Aspose.Slides для .NET. Выполнив эти шаги, вы можете программно извлечь данные из диаграммы в презентации PowerPoint и создать новую книгу Excel с восстановленными данными. Этот процесс может спасти жизнь, когда происходят несчастные случаи и данные необходимо спасти.

## Часто задаваемые вопросы

### Как установить Aspose.Slides для .NET?

 Вы можете скачать Aspose.Slides для .NET с сайта[здесь](https://downloads.aspose.com/slides/net).

### Могу ли я восстановить данные из разных типов диаграмм?

Да, Aspose.Slides for .NET поддерживает различные типы диаграмм, включая гистограммы, линейные диаграммы, круговые диаграммы и многое другое.

### Подходит ли Aspose.Slides for .NET для профессионального использования?

Абсолютно! Aspose.Slides for .NET — это надежная библиотека, используемая разработчиками для эффективной работы с презентациями PowerPoint.

### Существуют ли какие-либо лицензионные требования для использования Aspose.Slides для .NET?

 Да, для коммерческого использования Aspose.Slides for .NET требуется действующая лицензия. Подробную информацию о лицензировании можно найти на странице[Веб-сайт Aspose](https://purchase.aspose.com).

### Могу ли я настроить внешний вид восстановленной книги Excel?

Да, вы можете настроить внешний вид и форматирование книги Excel с помощью таких библиотек, как EPPlus или ClosedXML.