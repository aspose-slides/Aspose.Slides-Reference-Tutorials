---
"date": "2025-04-15"
"description": "Узнайте, как создавать и настраивать диаграммы с помощью Aspose.Slides для .NET, включая отображение процентов в виде меток данных. Следуйте этому пошаговому руководству."
"title": "Как создавать и настраивать диаграммы с помощью Aspose.Slides .NET&#58; Отображение процентов в виде меток"
"url": "/ru/net/charts-graphs/create-customize-charts-aspose-slides-dotnet/"
"weight": 1
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}
# Как создавать и настраивать диаграммы с помощью Aspose.Slides .NET: отображение процентов в виде меток

## Введение

Эффективное представление данных имеет решающее значение во многих областях, и диаграммы играют важную роль, превращая сложную информацию в понятные визуальные образы. Создание идеальной диаграммы включает в себя задачи настройки, такие как отображение процентов на этикетках — задача, которая упрощается с Aspose.Slides для .NET. Эта библиотека упрощает процесс создания и изменения диаграмм в презентациях PowerPoint.

В этом уроке вы узнаете, как использовать Aspose.Slides для .NET для создания с нуля столбчатой диаграммы с накоплением и ее настройки путем отображения процентных значений в качестве меток данных. Выполнив эти шаги, вы улучшите свои слайды с помощью точных и визуально привлекательных представлений данных.

**Что вы узнаете:**
- Инициализация Aspose.Slides для .NET
- Создание столбчатой диаграммы с накоплением
- Расчет и отображение процентов на этикетках данных
- Лучшие практики оптимизации производительности диаграмм

Прежде чем приступить к реализации, давайте убедимся, что у вас все готово для начала работы.

## Предпосылки

Чтобы эффективно следовать этому руководству, убедитесь, что у вас есть:
- **.NET Core SDK** установлен на вашем компьютере.
- Базовые знания в области разработки приложений на C# и .NET.
- Visual Studio или аналогичная IDE для написания и запуска кода C#.

Для создания диаграмм вам понадобится Aspose.Slides for .NET, поэтому убедитесь, что он настроен так, как описано ниже.

## Настройка Aspose.Slides для .NET

Aspose.Slides for .NET — мощная библиотека, которая позволяет работать с презентациями PowerPoint программно. Вот как добавить ее в свой проект:

### Установка

**.NET CLI:**
```bash
dotnet add package Aspose.Slides
```

**Консоль менеджера пакетов:**
```powershell
Install-Package Aspose.Slides
```

**Пользовательский интерфейс менеджера пакетов NuGet:** 
- Откройте NuGet Package Manager и найдите "Aspose.Slides". Установите последнюю версию.

### Приобретение лицензии

Чтобы полностью использовать Aspose.Slides, начните с бесплатной пробной версии. Для длительного использования рассмотрите возможность приобретения временной лицензии или покупки ее у [Aspose](https://purchase.aspose.com/buy). Следуйте их рекомендациям по настройке лицензии в среде вашего проекта.

### Базовая инициализация

После установки инициализируйте `Presentation` класс для начала создания слайдов:
```csharp
using Aspose.Slides;

// Инициализировать экземпляр класса представления
tPresentation presentation = new Presentation();
```

Теперь перейдем к реализации функции создания и настройки диаграмм с помощью Aspose.Slides для .NET.

## Руководство по внедрению

### Создайте столбчатую диаграмму с накоплением

Наша цель — создать составную столбчатую диаграмму и настроить ее, показывая проценты в качестве меток данных. Вот как:

#### Инициализировать презентацию

Начните с создания экземпляра `Presentation`:
```csharp
using Aspose.Slides;

// Инициализировать экземпляр класса представления
tPresentation presentation = new Presentation();
ISlide slide = presentation.Slides[0];
```

#### Добавить диаграмму на слайд

Добавьте на первый слайд столбчатую диаграмму с указанными координатами и размерами:
```csharp
IChart chart = slide.Shapes.AddChart(ChartType.StackedColumn, 20, 20, 400, 400);
```
Эта линия создает `StackedColumn` диаграмма в позиции (20, 20) с шириной и высотой 400.

#### Рассчитайте общие значения для расчета процентов

Чтобы отобразить проценты, рассчитайте общее значение для каждой категории по всем сериям:
```csharp
IChartSeries series;
double[] total_for_Cat = new double[chart.ChartData.Categories.Count];

for (int k = 0; k < chart.ChartData.Categories.Count; k++)
{
    IChartCategory cat = chart.ChartData.Categories[k];
    // Суммируйте значения всех рядов для каждой категории.
    for (int i = 0; i < chart.ChartData.Series.Count; i++)
    {
        total_for_Cat[k] += Convert.ToDouble(chart.ChartData.Series[i].DataPoints[k].Value.Data);
    }
}
```

#### Настройте метки данных для отображения процентных значений

Далее пройдитесь по каждой серии и настройте метки данных:
```csharp
for (int x = 0; x < chart.ChartData.Series.Count; x++)
{
    series = chart.ChartData.Series[x];
    series.Labels.DefaultDataLabelFormat.ShowLegendKey = false;

    for (int j = 0; j < series.DataPoints.Count; j++)
    {
        IDataLabel lbl = series.DataPoints[j].Label;
        
        // Рассчитать процент
        double dataPontPercent = (Convert.ToDouble(series.DataPoints[j].Value.Data) / total_for_Cat[j]) * 100;
        IPortion port = new Portion();
        port.Text = String.Format("{0:F2} %", dataPontPercent);
        port.PortionFormat.FontHeight = 8f;

        lbl.TextFrameForOverriding.Text = ""; // Очистить текст, чтобы избежать дублирования
        IParagraph para = lbl.TextFrameForOverriding.Paragraphs[0];
        para.Portions.Add(port);

        // Настройте формат метки, чтобы скрыть метки данных по умолчанию
        lbl.DataLabelFormat.ShowSeriesName = false;
        lbl.DataLabelFormat.ShowPercentage = false; 
        lbl.DataLabelFormat.ShowLegendKey = false;
        lbl.DataLabelFormat.ShowCategoryName = false;
        lbl.DataLabelFormat.ShowBubbleSize = false;
    }
}
```

В этом разделе вычисляется процент для каждой точки данных и устанавливается его как пользовательская метка, что гарантирует отсутствие перекрытия с метками по умолчанию.

#### Сохранить презентацию

Наконец, сохраните презентацию, чтобы просмотреть результат:
```csharp
string outputDir = "YOUR_OUTPUT_DIRECTORY";
presentation.Save(outputDir + "/DisplayPercentageAsLabels_out.pptx", SaveFormat.Pptx);
```

## Практические применения

Отображение процентов в диаграммах может быть особенно полезным в таких сценариях, как:
1. **Финансовая отчетность:** Показывать распределение портфеля или доходность инвестиций в процентах.
2. **Анализ продаж:** Представляйте данные о доле рынка в процентах, чтобы продемонстрировать эффективность по регионам.
3. **Результаты опроса:** Отображайте ответы на опросы в процентах для лучшего визуального сравнения.
4. **Управление проектом:** Используйте круговые диаграммы с процентами для иллюстрации распределения ресурсов.
5. **Образование:** Объясняйте статистические концепции, используя понятные наглядные пособия на основе процентных показателей.

Интеграция этих настраиваемых диаграмм в такие системы, как CRM или ERP, может улучшить панели мониторинга и отчеты, облегчая процессы принятия решений.

## Соображения производительности

При работе с Aspose.Slides для .NET, особенно с большими наборами данных:
- **Управление памятью:** Утилизируйте объекты презентации должным образом, чтобы освободить память. Используйте `using` заявления, где это применимо.
- **Эффективная обработка данных:** По возможности выполняйте вычисления вне циклов, чтобы сократить вычислительные затраты.
- **Балансировка нагрузки:** Для веб-приложений убедитесь, что ресурсы сервера достаточно выделены для одновременных запросов на генерацию диаграмм.

## Заключение

В этом руководстве рассматривается создание и настройка диаграмм с помощью Aspose.Slides для .NET путем отображения процентных значений в виде меток. Освоение этих методов позволяет вам улучшить свои презентации с помощью подробных и визуально привлекательных представлений данных.

В качестве следующего шага изучите другие типы диаграмм и параметры настройки, доступные в Aspose.Slides. Экспериментируйте с различными наборами данных, чтобы превратить их в мощные визуальные элементы, которые наглядно передают идеи.

## Раздел часто задаваемых вопросов

**В1: Как обрабатывать большие наборы данных при создании диаграмм с помощью Aspose.Slides для .NET?**
A1: Для больших наборов данных оптимизируйте вычисления и используйте эффективные методы управления памятью. Разбейте задачи обработки, чтобы избежать перегрузки памяти.

**В2: Могу ли я использовать Aspose.Slides для .NET в веб-приложении?**
A2: Да, его можно интегрировать в приложения ASP.NET. Обеспечьте правильное распределение ресурсов сервера для оптимальной производительности.

**В3: Можно ли экспортировать диаграммы, созданные с помощью Aspose.Slides, в другие форматы?**
A3: Конечно! Вы можете экспортировать презентации, содержащие ваши индивидуальные диаграммы, в различные форматы, такие как PDF и файлы изображений, используя возможности библиотеки.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}