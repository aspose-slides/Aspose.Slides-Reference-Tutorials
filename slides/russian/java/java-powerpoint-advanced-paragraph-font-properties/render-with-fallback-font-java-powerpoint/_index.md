---
title: Рендеринг с резервным шрифтом в Java PowerPoint
linktitle: Рендеринг с резервным шрифтом в Java PowerPoint
second_title: Aspose.Slides API обработки Java PowerPoint
description: Узнайте, как визуализировать текст с помощью резервных шрифтов в презентациях Java PowerPoint с помощью Aspose.Slides. Следуйте этому пошаговому руководству для беспрепятственного внедрения.
type: docs
weight: 13
url: /ru/java/java-powerpoint-advanced-paragraph-font-properties/render-with-fallback-font-java-powerpoint/
---
## Введение
Создание презентаций PowerPoint и управление ими на Java может быть сложной задачей, но с помощью Aspose.Slides вы можете сделать это эффективно. Одной из важнейших функций является возможность отображать текст с использованием резервных шрифтов. В этой статье представлено подробное пошаговое руководство по внедрению резервных шрифтов в слайды PowerPoint с помощью Aspose.Slides for Java.
## Предварительные условия
Прежде чем углубиться в реализацию, давайте убедимся, что у вас есть все необходимое:
1. Комплект разработки Java (JDK): убедитесь, что в вашей системе установлен JDK.
2.  Aspose.Slides для Java: его можно загрузить с сайта[Страница загрузки Aspose.Slides для Java](https://releases.aspose.com/slides/java/).
3. Интегрированная среда разработки (IDE): такие IDE, как IntelliJ IDEA или Eclipse, сделают ваш процесс разработки более плавным.
4. Зависимости: включите Aspose.Slides в зависимости вашего проекта.
## Импортировать пакеты
Сначала нам нужно импортировать необходимые пакеты в нашу Java-программу.
```java
import com.aspose.slides.*;
import javax.imageio.ImageIO;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
```
Давайте разобьем процесс на управляемые этапы.
## Шаг 1. Настройте свой проект
 Прежде чем писать какой-либо код, убедитесь, что ваш проект настроен правильно. Это включает в себя добавление библиотеки Aspose.Slides в ваш проект. Вы можете сделать это, скачав библиотеку с сайта[Aspose.Слайды для Java](https://releases.aspose.com/slides/java/) и добавив его в свой путь сборки.
## Шаг 2. Инициализация резервных правил шрифта
 Вам необходимо создать экземпляр`IFontFallBackRulesCollection` class и добавьте к нему правила. Эти правила определяют резервные шрифты для определенных диапазонов Юникода.
```java
// Путь к каталогу документов.
String dataDir = "Your Document Directory";
// Создайте новый экземпляр коллекции правил.
IFontFallBackRulesCollection rulesList = new FontFallBackRulesCollection();
// Создайте ряд правил
rulesList.add(new FontFallBackRule(0x0400, 0x04FF, "Times New Roman"));
```
## Шаг 3. Измените резервные правила
На этом этапе мы изменим резервные правила, удалив существующие резервные шрифты и обновив правила для определенных диапазонов Юникода.
```java
for (IFontFallBackRule fallBackRule : rulesList) {
    // Попытка удалить шрифт FallBack «Tahoma» из загруженных правил.
    fallBackRule.remove("Tahoma");
    // Обновить правила для указанного диапазона
    if ((fallBackRule.getRangeEndIndex() >= 0x4000) && (fallBackRule.getRangeStartIndex() < 0x5000)) {
        fallBackRule.addFallBackFonts("Verdana");
    }
}
//Удалите все существующие правила из списка.
if (rulesList.size() > 0) {
    rulesList.remove(rulesList.get_Item(0));
}
```
## Шаг 4. Загрузите презентацию
Загрузите презентацию PowerPoint, которую хотите изменить.
```java
Presentation pres = new Presentation(dataDir + "input.pptx");
```
## Шаг 5. Назначьте резервные правила презентации
Назначьте подготовленные резервные правила менеджеру шрифтов презентации.
```java
try {
    // Назначение подготовленного списка правил для использования
    pres.getFontsManager().setFontFallBackRulesCollection(rulesList);
    // Отображение миниатюры с использованием инициализированной коллекции правил и сохранение ее в формате PNG.
    BufferedImage image = pres.getSlides().get_Item(0).getThumbnail(1f, 1f);
    ImageIO.write(image, "png", new File(dataDir + "Slide_0.png"));
} catch (IOException e) {
    e.printStackTrace();
} finally {
    if (pres != null) pres.dispose();
}
```
## Шаг 6: Сохраните и протестируйте
Наконец, сохраните свою работу и протестируйте реализацию, чтобы убедиться, что все работает как положено. Если у вас возникнут какие-либо проблемы, дважды проверьте настройки и убедитесь, что все зависимости добавлены правильно.
## Заключение
Следуя этому руководству, вы сможете эффективно отображать текст с резервными шрифтами в презентациях PowerPoint с помощью Aspose.Slides для Java. Этот процесс гарантирует, что ваши презентации сохранят единообразное форматирование, даже если основные шрифты недоступны. Приятного кодирования!
## Часто задаваемые вопросы
### Что такое Aspose.Slides для Java?
Aspose.Slides for Java — это библиотека, которая позволяет разработчикам создавать, изменять и отображать презентации PowerPoint в приложениях Java.
### Как добавить Aspose.Slides в мой проект?
 Вы можете скачать библиотеку с сайта[Страница загрузки Aspose.Slides](https://releases.aspose.com/slides/java/) и добавьте его в путь сборки вашего проекта.
### Что такое резервные шрифты?
Резервные шрифты — это альтернативные шрифты, используемые, когда указанный шрифт недоступен или не поддерживает определенные символы.
### Могу ли я использовать несколько резервных правил?
Да, вы можете добавить несколько резервных правил для обработки различных диапазонов и шрифтов Юникода.
### Где я могу получить поддержку для Aspose.Slides?
 Вы можете получить поддержку от[Форум поддержки Aspose.Slides](https://forum.aspose.com/c/slides/11).